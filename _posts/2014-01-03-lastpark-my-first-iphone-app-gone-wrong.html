---
layout: post
title: 'LastPark: my first iPhone app gone wrong'
date: '2014-01-03T10:26:00.001-08:00'
author: Eugene Yakubovich
tags:
- iOS
modified_time: '2014-01-03T10:26:31.804-08:00'
blogger_id: tag:blogger.com,1999:blog-7098284592115366563.post-4684308318937897294
blogger_orig_url: http://dev-perspective.blogspot.com/2014/01/lastpark-my-first-iphone-app-gone-wrong.html
---

I decided to venture out into the unknown -- iOS development. My first app -- LastPark -- saves the last location where the car was parked. I was solely trying to scratch a personal itch as I often forget on what street or what end of the parking lot I parked at. There are plenty of apps out there that allow you to mark the location of the vehicle but that requires remembering to do that before you're lost! Then there are Bluetooth LE devices that you can purchase and install in your car. When you shut your engine the device turns off and the app loses connectivity to it, causing it to save the location. $99 <a href="http://www.automatic.com/">Automatic</a>&nbsp;will also provide a slew of other features while the $25 <a href="http://findmycarsmarter.com/">Find My Car Smarter</a>&nbsp;is very basic.<br /><br />However my car already has the Bluetooth built in and moreover connects to my iPhone every time I get in to provide me with hands free calling. Why, I thought, would I need to buy another Bluetooth device when I got all the parts already installed. This is when I decided to write LastPark. (Technically I had to spend $99 to join the Apple Developer Program -- the same price as the fancy Automatic).<br /><br />Unfortunately getting access to plain old Bluetooth (not the new Low Energy one) is not exactly easy in iOS. It seems like the only way was to use a private framework (undocumented). The upside is that a few people have already gone this route and there's even a <a href="https://github.com/michaeldorner/BeeTee">demo project on GitHub</a> that I used as a starting point. The downside is that Apple does not allow apps that use private frameworks in the AppStore. Not a biggie for me as I was developing it for my own use.<br /><br />What killed this app was the inability to run it in the background. After some time in the background state the app gets suspended and doesn't get woken up for Bluetooth notifications. I tried specifying various background mode preferences in the plist but to no avail. I realize that Apple tries to improve the battery life by limiting the amount of work the apps can do in the background. However I believe it should be more liberal in allowing apps to register for notifications of ambient activities. These registrations probably take just a few bytes in some table inside a daemon (that's running anyway) and don't take much resources.<br /><br />I've <a href="https://github.com/eyakubovich/LastPark">released</a> what I got on GitHub. Any comments on how to get this to work as desired would be greatly appreciated.